# Custom PyTorch Pipeline Configuration

# Dataset Configuration
dataset:
  root_dir: "dataset"
  train_dir: "train"
  val_dir: "val"
  test_dir: "test"
  input_size: 224
  batch_size: 8
  num_workers: 4
  
# Class Configuration
classes:
  names: [] # Use classes.txt (cat, dog)
  num_classes: 2
  class_weights: [1.0, 1.0]  # Weighted loss for imbalance

# Model Configuration
model:
  name: "convnextv2_large"
  pretrained: True
  drop_path_rate: 0.1
  in_chans: 3

# Training Configuration
training:
  epochs: 10
  learning_rate: 1e-4
  weight_decay: 1e-4
  warmup_epochs: 5
  min_lr: 1e-6
  
  # Preprocessing Features
  use_fda: false
  use_hist_norm: false
  use_bg_masking: false


  # Augmentations 
  augmentation:
    horizontal_flip: 0.0
    vertical_flip: 0.0
    rotation: 0.
    brightness: 0.0
    contrast: 0.0
    saturation: 0.0
    hue: 0.00
    
    # Advanced Augmentations
    mixup:
      enabled: true
      alpha: 0.2
      beta: 0.2
    
    cutmix:
      enabled: true
      alpha: 1.0
    
    randaugment:
      enabled: true
      n: 1
      m: 5
    
    color_jitter:
      enabled: true
      brightness: 0.5
      contrast: 0.1
      saturation: 0.1
      hue: 0.05
  
  
  # Training Options
  freeze_backbone: True
  use_amp: true
  gradient_clip: 1.0
  
# Inference Configuration
inference:
  threshold: 0.5
  device: "cuda"
  
# Paths Configuration
paths:
  tao_weights: "../pretrained_models/pretrained_convnextv2_vconvnextv2_large_v1.0/convnextv2_large_trainable_v1.0.pth"
  output_dir: "outputs"
  log_dir: "logs"
  checkpoint_dir: "checkpoints"
  visualization_dir: "visualizations"

# Logging Configuration
logging:
  log_interval: 10
  save_interval: 5
  eval_interval: 2

# FDA Parameters
fda:
  beta_range: [0.1, 0.4]
  reference_dir: 'dataset/test/dog/dog.4001.jpg'
  
# Hardware Configuration
hardware:
  device: "cuda"
  mixed_precision: true
